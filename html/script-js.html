<script>
  const calcBtn = document.getElementById("calcBtn");
  calcBtn.addEventListener("click", calcFn);

  function onSuccess(which) {
    const sol = document.getElementById("sol" + which);
    return (solution) => {
      if (!solution) sol.value = "NaN";
      else sol.value = solution;
    };
  }

  function calcFn() {
    const p1 = document.getElementById("p1");
    const p2 = document.getElementById("p2");
    const p3 = document.getElementById("p3");
    google.script.run
      .withSuccessHandler(onSuccess(1))
      .quadraticSolution(p1.value, p2.value, p3.value, 0);

    google.script.run
      .withSuccessHandler(onSuccess(2))
      .quadraticSolution(p1.value, p2.value, p3.value, 1);
  }
</script>
